<html xmlns:th="https://www.thymeleaf.org">
<head>
    <title th:text="${nombreParticipante}"></title>
    <th:block th:include="fragments/head :: genericHead"></th:block>
    <th:block th:include="fragments/head :: datatablesHead"></th:block>
    <script type="text/javascript" src="/js/ScrollUtils.js"></script>
    <script type="text/javascript" src="/js/ModalUtils.js"></script>
    <link rel="stylesheet" href="/css/evento.css"/>
    <link rel="stylesheet" href="/css/cubing-icons.css"/>
    <link rel="stylesheet" href="/css/tooltips.css"/>


</head>


<body class="cubosbg">

<script>

    $(function () {
        $('[data-toggle="tooltip"]').tooltip()
    })

</script>
<div th:replace="fragments/backButton :: backButton"/>
<div class="vertical-flex-wrapper">
    <div class="whitePanel" style="margin-top: 50px;">
        <h1 style="text-align: center;">
            <img src="/img/userIcon.png" style="width: 100px; height: 100px"/>
            <span th:text="${nombreParticipante}"/>
        </h1>
    </div>

    <div class="whitePanel" style="margin-top: 50px;">
        <h1 style="text-align: center; padding-bottom: 30px">
            Competiciones completadas
        </h1>

        <table class="table dataTable centerCols" style="font-size: 20px;">
            <thead>
            <th>Competición</th>
            <th colspan="100%">Categorías completadas</th>
            </thead>
            <tbody th:each="competicion: ${resultados}" class="alto">
            <tr>

                <td rowspan="2"><a
                        th:href="@{|/participante/${nombreParticipante}/${competicion.getKey().getNombre()}|}"><span
                        th:text="${competicion.getKey().getNombre()}"/></a>
                </td>

                <td th:each="posicion : ${competicion.getValue()}" style="border-bottom: 0">

                    <div class="tooltip"><a th:href="@{|/participante/${nombreParticipante}/${competicion.getKey().getNombre()}/#${posicion.getCategoria().getNombre()}|}"><span
                            th:class="'cubing-icon event-' + ${posicion.getCategoria().getNombre()}"/></a>
                        <span class="tooltiptext">Ver todos los tiempos</span>
                    </div>

                </td>
            </tr>
            <tr>
                <td th:each="posicion : ${competicion.getValue()}">
                    <div style="display: flex; align-items: center">
                        <div class="tooltip">
                            <a th:href="@{|/ranking/${competicion.getKey().getNombre()}/${posicion.getCategoria().getNombre()}/#${nombreParticipante}|}">
                                <span th:text="${posicion.getPosicionGeneral()+'º'}" />
                            </a>
                            <span class="tooltiptext">Posición en el ránking (con <span style="font-weight: bold" th:text="${posicion.getPuntuacionTotal()}" /> puntos)</span>
                        </div>
                        <span th:if="${posicion.isClasificado()}">&rarr;</span>
                        <div th:if="${posicion.isClasificado()}" class="tooltip" style="height: 50px; width: 50px">
                            <a onclick="loadModal(this)" th:data-nombreCategoria="${posicion.getCategoria().getNombre()}" data-toggle="modal" data-target="#playOffsModal" class="bouncyContainer">
                                <img class="bouncyButton podio" th:if="${posicion.getMedalla() != null && !'OTRO'.equals(posicion.getMedalla())}" th:src="'/img/'+${posicion.getMedalla()+'.png'}" />
                                <img class="bouncyButton podio" th:if="${'OTRO'.equals(posicion.getMedalla())}"  src="/img/bracket.png"/>
                            </a>
                            <span class="tooltiptext">Posición en playoffs</span>
                        </div>
                    </div>
                </td>
            </tr>
            </tbody>
        </table>
    </div>

</div>
<th:block th:include="fragments/modal :: modalBracket"></th:block>

<script th:inline="javascript">

    function loadModal(activador) {

        var nombreCategoria = $(activador).attr("data-nombreCategoria");
        loadBracket(nombreCategoria);
    }

</script>
</body>
</html>